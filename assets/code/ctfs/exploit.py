from pwn import *

N64 = 2 ** 64 - 1 # 64 bit integer with all bits set to 1
N63 = 2 ** 63 - 1 # 63 bit integer with all bits set to 1

p = process(["/usr/bin/python2", "./guesskey.py"])
success = 0
response = ""
attempt = 0
while True:
    print(f"attempt: {attempt}")
    attempt += 1
    maybe_flag = p.recvline() # receive "mask:\n" or "flag\n"
    if "flag" in maybe_flag.decode('utf-8'):
        print(maybe_flag)
        break
    p.sendline(str(N64))
    print(p.recvline()) # receive "guess:\n"
    if success % 2 == 0:
        p.sendline(str(N64))
    else:
        p.sendline(str(N63))
    response = p.recvline().decode('utf-8')
    if "Oo" not in response:
        success += 1
    if attempt > 300:
        break